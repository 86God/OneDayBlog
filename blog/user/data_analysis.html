<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>layuiAdmin 控制台主页一</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" href="../plugins/layuiadmin/layui/css/layui.css" media="all">
		<link rel="stylesheet" href="../plugins/layuiadmin/style/admin.css" media="all">
		
	</head>

	<body>

		<div class="layui-fluid">
			<div class="layui-row layui-col-space15">
				<div class="layui-col-md7">
					<div class="layui-row layui-col-space15">
						<div class="layui-col-md12">
							<div class="layui-card">
								<div class="layui-card-header">创作数据</div>
								<div class="layui-card-body">
									<div class="layui-carousel layadmin-carousel layadmin-backlog"  style="height: 200px !important;">
										<div carousel-item>
											<ul class="layui-row layui-col-space10" id="userData">
												<li class="layui-col-xs3">
													<a lay-href="app/content/comment.html" class="layadmin-backlog-body">
														<h3>帖子</h3>
														<p><cite></cite></p>
													</a>
												</li>
												<li class="layui-col-xs3">
													<a lay-href="app/forum/list.html" class="layadmin-backlog-body">
														<h3>浏览量</h3>
														<p><cite></cite></p>
													</a>
												</li>
												<li class="layui-col-xs3">
													<a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
														<h3>评论</h3>
														<p><cite></cite></p>
														
													</a>
												</li>
												<li class="layui-col-xs3">
													<a lay-href="template/goodslist.html" class="layadmin-backlog-body">
														<h3>点赞</h3>
														<p><cite></cite></p>
														
													</a>
												</li>
												
												<li class="layui-col-xs3">
													<a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
														<h3>收藏</h3>
														<p><cite></cite></p>
														
													</a>
												</li>
												<li class="layui-col-xs3">
													
													<a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
														<h3>关注我的人</h3>
														<p><cite></cite></p>
														
													</a>
												</li>
												<li class="layui-col-xs3">
													<a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});" class="layadmin-backlog-body">
														<h3>我关注的人</h3>
														<p><cite></cite></p>
														
													</a>
												</li>
											</ul>

										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="layui-col-md12" >
							<div class="layui-card">
								<div class="layui-card-header">数据概览</div>
								<div class="layui-card-body">
									<div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-dataview" style="height: 500px !important;">
					                  <div carousel-item >
					                    <div id="char1" style="height: 330px; width: 700px;"></div>
											<div id="char2" style="height: 330px; width: 700px;"></div>
											<div id="char3" style="height: 330px; width: 700px;"></div>
					                  </div>
					                </div>


								</div>
							</div>

						</div>
					</div>
				</div>

				<div class="layui-col-md5">
					<div class="layui-card">
						<div class="layui-card-header">今日热度排行</div>
						<div class="layui-card-body layui-text">
							<div class="layui-carousel layadmin-carousel layadmin-shortcut">
								<div carousel-item >
									<table class="layui-table">
										<colgroup>
											<col width="100">
											<col>
										</colgroup>
										<tbody id='todayHot'>
											<tr>
												<th>排名</th>
												<th>文章</th>
												<th>今天</th>
												<th>累计</th>
												<th>点赞</th>
												<th>收藏</th>
												<th>评论</th>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>	
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					
					<div class="layui-card">
						<div class="layui-card-header">累计热度排行</div>
						<div class="layui-card-body layui-text">
							<div class="layui-carousel layadmin-carousel layadmin-shortcut">
								<div carousel-item >
									<table class="layui-table">
										<colgroup>
											<col width="100">
											<col>
										</colgroup>
										<tbody id='historyHot'>
											<tr>
												<th>排名</th>
												<th>文章</th>
												<th>今天</th>
												<th>累计</th>
												<th>点赞</th>
												<th>收藏</th>
												<th>评论</th>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>	
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
	
	
				</div>

			</div>
		</div>

		<script type="text/javascript" src="../js/jQuery3.5.1.js" ></script>
		<script type="text/javascript" src="../js/common.js" ></script>
		<script type="text/javascript" src="../js/requestParam.js" ></script>
	    <script type="text/javascript" src="../plugins/echarts/echarts-all.js" ></script>
		<script src="../plugins/layui/layui.js"></script>
		
		<script>
			layui.config({
				base: '../plugins/layuiadmin/' //静态资源所在路径
			}).extend({
				index: 'lib/index' //主入口模块
			}).use(['index', 'console']);	
			
			
			$(function(){
				$userData = $('#userData').children();
				
				//用户创作数据
				$.ajax({
					type:"get",
					url:localhost+"userCtl/findCreateData?userId="+sessionStorage.getItem("userId"),
					async:true,
					dataType:'json',
					success:function(res){
						$userData.eq(0).find('a').find('p').find('cite').text(res.artNum);						
						$userData.eq(1).find('a').find('p').find('cite').text(res.viewNum);						
						$userData.eq(2).find('a').find('p').find('cite').text(res.commentNum);						
						$userData.eq(3).find('a').find('p').find('cite').text(res.likeNum);						
						$userData.eq(4).find('a').find('p').find('cite').text(res.collectNum);						
						$userData.eq(5).find('a').find('p').find('cite').text(res.focusNum);						
						$userData.eq(6).find('a').find('p').find('cite').text(res.concernNum);
					}
				});
				
				$todayHot = $('#todayHot').children();
				//用户今日热门帖子
				$.ajax({
					type:"get",
					url:localhost+"userCtl/findTodayHot?userId="+sessionStorage.getItem("userId"),
					async:true,
					dataType:'json',
					success:function(res){
					
						for(var i = 0;i<res.length;i++){
							var $tr = $todayHot.eq(i+1);
							
							$tr.children().eq(0).text(i+1);
							$tr.children().eq(1).text(res[i].title);
							$tr.children().eq(2).text(res[i].viewNum);
							$tr.children().eq(3).text(res[i].page_view);
							$tr.children().eq(4).text(res[i].likes);
							$tr.children().eq(5).text(res[i].collect);
							$tr.children().eq(6).text(res[i].comment_num);
						}
					}		
				});
				
				
				$historyHot = $('#historyHot').children();
				//用户历史热门帖子
				$.ajax({
					type:"get",
					url:localhost+"userCtl/findHistoryHot?userId="+sessionStorage.getItem("userId"),
					async:true,
					dataType:'json',
					success:function(res){
						for(var i = 0;i<res.length;i++){
							var $tr = $historyHot.eq(i+1);
							
							$tr.children().eq(0).text(i+1);
							$tr.children().eq(1).text(res[i].title);
							$tr.children().eq(2).text(res[i].viewNum);
							$tr.children().eq(3).text(res[i].page_view);
							$tr.children().eq(4).text(res[i].likes);
							$tr.children().eq(5).text(res[i].collect);
							$tr.children().eq(6).text(res[i].comment_num);
						}
					}		
				});
				
	
				//用户当天的数据图表
			    var myChart1 = echarts.init(document.getElementById('char1'));
			    $.post(localhost + 'userCtl/findChartInfo?action=getToday&userId='+sessionStorage.getItem("userId"),function (res) {
			    	console.log(res);
					var option = {
					    title : {
					        text: '今天创作数据分析',
					        subtext: '按照时间段来分析'
					    },
					    tooltip : {
					        trigger: 'axis'
					    },
					    legend: {
					        data:['阅读量','创作量','评论量']
					    },
					    toolbox: {
					        show : true,
					        feature : {
					            mark : {show: true},
					            dataView : {show: true, readOnly: false},
					            magicType : {show: true, type: ['line', 'bar']},
					            restore : {show: true},
					            saveAsImage : {show: true}
					        }
					    },
					    calculable : true,
					    xAxis : [
					        {
					            type : 'category',
					            boundaryGap : false,
					            data : res.timeNumList
					        }
					    ],
					    yAxis : [
					        {
					            type : 'value',
					            axisLabel : {
					                formatter: '{value}'
					            }
					        }
					    ],
					    series : [
					        {
					            name:'阅读量',
					            type:'line',
					            data:res.viewNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name: '平均值'}
					                ]
					            }
					        },
					        {
					            name:'创作量',
					            type:'line',
					            data:res.artNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        },
					        {
					            name:'评论量',
					            type:'line',
					            data:res.commentNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        }
					    ]
					};
			                    
			        myChart1.setOption(option);
			    },"json");
			    
			    //用户最近7天的数据图表
			    var myChart2 = echarts.init(document.getElementById('char2'));
			    $.post(localhost + 'userCtl/findChartInfo?action=getWeek&userId='+sessionStorage.getItem("userId"),function (res) {
			    	console.log(res);
					var option = {
					    title : {
					        text: '今天创作数据分析',
					        subtext: '按照时间段来分析'
					    },
					    tooltip : {
					        trigger: 'axis'
					    },
					    legend: {
					        data:['阅读量','创作量','评论量']
					    },
					    toolbox: {
					        show : true,
					        feature : {
					            mark : {show: true},
					            dataView : {show: true, readOnly: false},
					            magicType : {show: true, type: ['line', 'bar']},
					            restore : {show: true},
					            saveAsImage : {show: true}
					        }
					    },
					    calculable : true,
					    xAxis : [
					        {
					            type : 'category',
					            boundaryGap : false,
					            data : res.timeNumList
					        }
					    ],
					    yAxis : [
					        {
					            type : 'value',
					            axisLabel : {
					                formatter: '{value}'
					            }
					        }
					    ],
					    series : [
					        {
					            name:'阅读量',
					            type:'line',
					            data:res.viewNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name: '平均值'}
					                ]
					            }
					        },
					        {
					            name:'创作量',
					            type:'line',
					            data:res.artNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        },
					        {
					            name:'评论量',
					            type:'line',
					            data:res.commentNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        }
					    ]
					};
			                    
			        myChart2.setOption(option);
			    },"json");
			    
			    //用户最近30天的数据图表
			    var myChart3 = echarts.init(document.getElementById('char3'));
			    $.post(localhost + 'userCtl/findChartInfo?action=getMonth&userId='+sessionStorage.getItem("userId"),function (res) {
			    	console.log(res);
					var option = {
					    title : {
					        text: '今天创作数据分析',
					        subtext: '按照时间段来分析'
					    },
					    tooltip : {
					        trigger: 'axis'
					    },
					    legend: {
					        data:['阅读量','创作量','评论量']
					    },
					    toolbox: {
					        show : true,
					        feature : {
					            mark : {show: true},
					            dataView : {show: true, readOnly: false},
					            magicType : {show: true, type: ['line', 'bar']},
					            restore : {show: true},
					            saveAsImage : {show: true}
					        }
					    },
					    calculable : true,
					    xAxis : [
					        {
					            type : 'category',
					            boundaryGap : false,
					            data : res.timeNumList
					        }
					    ],
					    yAxis : [
					        {
					            type : 'value',
					            axisLabel : {
					                formatter: '{value}'
					            }
					        }
					    ],
					    series : [
					        {
					            name:'阅读量',
					            type:'line',
					            data:res.viewNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name: '平均值'}
					                ]
					            }
					        },
					        {
					            name:'创作量',
					            type:'line',
					            data:res.artNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        },
					        {
					            name:'评论量',
					            type:'line',
					            data:res.commentNumList,
					            markPoint : {
					                data : [
					                    {type : 'max', name: '最大值'},
					                    {type : 'min', name: '最小值'}
					                ]
					            },
					            markLine : {
					                data : [
					                    {type : 'average', name : '平均值'}
					                ]
					            }
					        }
					    ]
					};
			                    
			        myChart3.setOption(option);
			    },"json")
			});
		</script>
	</body>

</html>